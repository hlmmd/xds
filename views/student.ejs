<% include header %>

<div class="page-header">
    <h3>学生信息</h3>
</div>

<div>
    <form method="get" id="studentform">
        <input type="text" name="student_id" id="student_id" placeholder="请输入学号" required>
        <input type="submit" value="查询">
    </form>
</div>
<hr>

<% if(locals.failinfo) { %>
<div class="alert alert-warning " role="alert">
    <strong><%= failinfo %></strong>
</div>
<% }  %>

<% if ( locals.stu_info) { %>


<% if (stu_info.photo_suffix !='' ){ %>

<div class="">
    <form method="post" action="uploadphoto?student_id=<%= stu_info.student_id %>" enctype="multipart/form-data"
        id="photoform">
        <div class="form-group controls">
            <div class="row col-md-2">
                <img src="student_photo/<%= stu_info.student_id %>.<%= stu_info.photo_suffix %>" class="img-responsive">
            </div>
            <input type="file" name="photo" id="photo" accept="image/*">
            <input type="submit" value="保存图片">
            <a href="/delstuphoto?student_id=<%= stu_info.student_id %>"><input type="button" name="delete_stu_photo"
                    id="delete_stu_photo" value="删除照片" class="btn btn-danger"> </a>
        </div>
    </form>
</div>

<% } else { %>
<div>
    <form method="post" action="/uploadphoto?student_id=<%= stu_info.student_id %>" id="photoform"
        enctype="multipart/form-data">
        <div class="form-group controls">
            <input type="file" name="photo" id="photo" accept="image/*">
            <input type="submit" value="保存图片">
        </div>
    </form>
</div>
<% } %>


<div>
    <form method="post" id="studentinfo">
        <table class="table table-bordered">
            <tr>
                <td><strong>学号</strong></td>
                <td><input type="text" name="info_student_id" id="info_student_id" value="<%= stu_info.student_id %>"
                        disabled></td>

                <td><strong>姓名</strong></td>
                <td><input type="text" name="info_name" id="info_name" value="<%= stu_info.name %>"> </td>

                <td><strong>就业年份</strong></td>
                <td><input type="text" name="info_year" id="info_year" value="<%= stu_info.year %>"> </td>
            </tr>

            <tr>
                <td><strong>省份</strong></td>
                <td><input type="text" name="info_province" id="info_province" disabled
                        value="<%= stu_info.province %>"> </td>
            </tr>

            <tr>
                <td colspan="6" class="text-center"> <input type="submit" value="保存"></td>
            </tr>

        </table>
    </form>
</div>



<% if ( locals.careers) { %>
<div class="page-header">
    <h3>工作经历</h3>
</div>

<div>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th hidden> id </th>
                <th>序号</th>
                <th>开始时间</th>
                <th>结束时间</th>
                <th>单位名称</th>
                <th>职位名称</th>
                <th>职级</th>
                <th>操作</th>
                <th>删除</th>
            </tr>
        </thead>

        <tbody>
            <% for (i =0 ;i<careers.length;i++) { %>
            <tr class="bg-success">
                <form action="/updatecareer?student_id=<%= stu_info.student_id %>" method="POST">
                    <td hidden><input type="text" name="career_id" id="career_id" value="<%= careers[i].id %>"> </td>
                    <td><%= i+1 %></td>
                    <td><input type="date" name="career_start_time" id="career_start_time"
                            value="<%=  careers[i].start_time %>" required></td>
                    <td><input type="date" name="career_end_time" id="career_end_time"
                            value="<%= careers[i].end_time %>" required> </td>
                    <td><input type="text" name="career_unit" id="career_unit" value="<%= careers[i].unit %>" required>
                    </td>
                    <td><input type="text" name="career_position" id="career_position"
                            value="<%= careers[i].position %>" required> </td>

                    <td>
                        <% if (locals.career_levels) { %>
                        <select name="career_level" id="career_level">
                            <% for (j= 0;j<career_levels.length;j++) { %>
                            <% if(career_levels[j]==careers[i].level) { %>
                            <option value="<%= career_levels[j] %>" selected> <%= career_levels[j] %></option>
                            <% } else {%>
                            <option value="<%= career_levels[j] %>"> <%= career_levels[j] %></option>
                            <% } }%>
                        </select>
                        <% } else {%>
                        <input type="text" name="career_level" id="career_level" value="" required>
                        <% } %>

                    </td>
                    <td> <input type="submit" value="保存"></td>
                    <td><a href="/delcareer?student_id=<%= stu_info.student_id %>&career_id=<%= careers[i].id %>">
                            <input type="button" value="删除"> </a></td>
                </form>
            </tr>

            <% } %>


            <tr class="bg-danger">
                <form action="/addcareer?student_id=<%= stu_info.student_id %>" id="addcareer" method="POST">
                    <td><label><%= careers.length+1 %></label></td>
                    <td><input type="date" name="career_start_time" id="career_start_time" required></td>
                    <td><input type="date" name="career_end_time" id="career_end_time" required> </td>
                    <td><input type="text" name="career_unit" id="career_unit"> </td>
                    <td><input type="text" name="career_position" id="career_position"> </td>
                    <td>
                        <% if (locals.career_levels) { %>
                        <select name="career_level" id="career_level">
                            <% for (i= 0;i<career_levels.length;i++) { %>
                            <option value="<%= career_levels[i] %>"> <%= career_levels[i] %></option>
                            <% } %>
                        </select>
                        <% } else {%>
                        <input type="text" name="career_level" id="career_level" value="" required>
                        <% } %>

                    </td>
                    <td colspan="2"><input type="submit" value="添加"></td>
                </form>
            </tr>
        </tbody>
    </table>

</div>

<% }  %>

<div class="page-header">
    <h3>删除学生</h3>
</div>

<a href="/delstu?student_id=<%= stu_info.student_id %>"><input type="button" name="delete_stu" id="delete_stu"
        value="删除该学生" class="btn btn-danger"> </a>



<% } else if(locals.notfound){ %>

<div class="alert alert-warning " role="alert">
    <strong><%= notfound%></strong>
</div>
<% } %>

<% include footer %>